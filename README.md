## Транспортный уровень распределенной информационной системы с использованием Django и Kafka

### Обзор

Транспортный уровень отвечает за передачу сегментов файлов от отправителя к получателю через Kafka. Файлы разбиваются на сегменты по 1000 байт и отправляются отдельными сегментами на канальный уровень.

При получении сегменты помещаются в очередь, раз в 7 секунд собираются в единое сообщение и передаются на прикладной уровень. Если часть из сегментов не была принята, то на прикладной уровень итоговое сообщение передается с признаком ошибки.

Каждый пакет-сегмент представляет собой полезную нагрузку, времени отправки (как id сообщения), общую длину сообщения (количество сегментов) и номер данного сегмента в сообщении.

### Компоненты

#### Segment

Класс `Segment` представляет собой сегмент файла, содержащий следующую информацию:

- `username`: Имя пользователя, отправившего сегмент.
- `segment_num`: Номер сегмента в сообщении.
- `segment_len`: Общая длина сообщения (количество сегментов).
- `payload`: Полезная нагрузка сегмента.
- `time`: Время отправки сегмента.

#### Message

Класс `Message` представляет собой сообщение, состоящее из одного или нескольких сегментов. Он содержит методы для добавления сегментов, проверки на ошибки и создания файла из сегментов.

### Функции

#### SendSegment

Функция `SendSegment` принимает файл от пользователя и разбивает его на сегменты размером в 1000 байт. Каждый сегмент отправляется на канальный уровень через HTTP запрос к `channel_layer_url`.

#### TransferSegment

Функция `TransferSegment` принимает данные сегмента через POST-запрос и отправляет их в Kafka топик `segment_topic`.

#### read_messages_from_kafka

Функция `read_messages_from_kafka` читает сегменты из Kafka топика и собирает их в сообщения. Сообщения собираются каждые 7 секунд и передаются на прикладной уровень через функцию `send_mesg_to_app_layer`.

#### send_mesg_to_app_layer

Функция `send_mesg_to_app_layer` отправляет собранные сообщения на прикладной уровень через HTTP POST запрос к `application_layer_url`. Если сообщение содержит ошибку (не все сегменты были приняты), оно помечается как ошибочное.
